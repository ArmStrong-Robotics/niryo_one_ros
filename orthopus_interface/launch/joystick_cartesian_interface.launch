<launch>
    <arg name="joy_enabled" default="true" />
    <arg name="joy_device" default="js0" />
    <arg name="xbox" default="false" />
    <arg name="spacenav" default="false" />
    <arg name="webapp" default="true" />
    <arg name="host_ip" default="127.0.0.1" />

    <group if="$(arg joy_enabled)">
        <group if="$(arg xbox)">
            <param name="joy_node/deadzone" value="0.2" type="double"/>
            <param name="joy_node/coalesce_interval" value="0.01" type="double"/>
            <param name="joy_node/autorepeat_rate" value="50" type="double"/>
            <param name="joy_node/dev" value="/dev/input/$(arg joy_device)" type="string"/>
            <node name="joy_node" pkg="joy" type="joy_node" output="screen" respawn="false" />
            <node name="xbox_wrapper" pkg="orthopus_interface" type="xbox_wrapper" output="screen" respawn="false"/>
        </group>
        <group if="$(arg spacenav)">
            <node name="spacenav_node" pkg="spacenav_node" type="spacenav_node" output="screen" respawn="false">
              <rosparam param="static_rot_deadband">0.5</rosparam>
              <rosparam param="static_trans_deadband">0.5</rosparam>
            </node>
            <node name="spacenav_wrapper" pkg="orthopus_interface" type="spacenav_wrapper" output="screen" respawn="false"/>
        </group>
        <group if="$(arg webapp)">

            <node name="web_app_wrapper" pkg="orthopus_interface" type="web_app_wrapper" output="screen" respawn="false"/>    
            <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" output="screen" respawn="true"/>

            <node pkg="nodelet" type="nodelet" name="libuvc_camera" args="load libuvc_camera/driver /nodelet_manager" output="screen" respawn="true">
              <param name="frame_id" value="hand_link" />
              <!-- Parameters used to find the camera -->
              <param name="vendor" value="0x045e"/>
              <param name="product" value="0x0810"/>

              <!-- Image size and type -->
              <param name="width" value="640"/>
              <param name="height" value="360"/>
              <param name="video_mode" value="mjpeg"/>
              <param name="frame_rate" value="15"/>
            </node>
            <node pkg="web_video_server" type="web_video_server" name="web_video_server" output="screen"/>
          </group>
    </group>
    
    <node name="cartesian_controller" pkg="orthopus_interface" type="cartesian_controller" output="screen" respawn="false" >
      <rosparam file="$(find orthopus_interface)/config/settings.yaml"/>
    </node>
    <node name="orthopus_move_group" pkg="orthopus_interface" type="move_group_node" output="screen" respawn="false" >
<!--       <rosparam file="$(find orthopus_interface)/config/settings.yaml"/> -->
    </node>
</launch>
